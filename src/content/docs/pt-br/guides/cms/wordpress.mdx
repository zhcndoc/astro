---
title: Headless WordPress & Astro
description: Adicione conte√∫do ao seu projeto Astro usando WordPress como CMS
type: cms
stub: false
service: WordPress
i18nReady: true
---
import { FileTree } from '@astrojs/starlight/components';
import Grid from '~/components/FluidGrid.astro'
import Card from '~/components/ShowcaseCard.astro'

[WordPress](https://wordpress.org/) √© um sistema de gerenciamento de conte√∫do que disp√µe de seu pr√≥prio frontend, mas que tamb√©m pode ser usado como CMS headless para fornecer conte√∫do ao seu projeto Astro.

## Integrando com Astro

WordPress vem com uma [WordPress REST API](https://developer.wordpress.org/rest-api/) embutida para conectar seus dados WordPress com Astro. Voc√™ pode instalar opcionalmente [WPGraphQL](https://wordpress.org/plugins/wp-graphql/) em seu site para usar GraphQL.

### Pr√©-requisitos

Para come√ßar, voc√™ precisa ter o seguinte:

1. **Um projeto Astro** - Se voc√™ ainda n√£o tem um projeto Astro, nosso [Guia de Instala√ß√£o](/pt-br/install-and-setup/) far√° voc√™ construir um projeto o quanto antes.
2. **Um site WordPress** - A API REST do seu site √© `[SEU_SITE]/wp-json/wp/v2/` e est√° dispon√≠vel por padr√£o em qualquer site WordPress. Tamb√©m √© poss√≠vel [configurar WordPress em um ambiente local](https://wordpress.org/support/article/installing-wordpress-on-your-own-computer/).

### Configurando Credenciais

Sua WordPress REST API est√° dispon√≠vel para obter dados sem qualquer autentica√ß√£o por padr√£o. Isso n√£o permite que os usu√°rios modifiquem seus dados ou as configura√ß√µes do seu site, e permite que voc√™ use os dados em seu projeto Astro sem qualquer credencial.

Voc√™ pode escolher [exigir autentica√ß√£o](https://developer.wordpress.org/rest-api/frequently-asked-questions/#require-authentication-for-all-requests) se necess√°rio.

### Obtendo Dados

Obtenha dados do seu WordPress atrav√©s da sua URL REST API √∫nica e da rota para o seu conte√∫do. (Para um blog, isso seria comumente `posts`.) Ent√£o, voc√™ pode mostrar as propriedades dos seus dados utilizando a diretiva `set:html={}` do Astro. 

Por exemplo, para mostrar uma lista de t√≠tulos de post e seu conte√∫do:

```astro title="src/pages/index.astro"
---
const res = await fetch("https://[SEU-SITE]/wp-json/wp/v2/posts");
const posts = await res.json();
---
<h1>Astro + WordPress üöÄ</h1>
{
  posts.map((post) => (
      <h2 set:html={post.title.rendered} />
      <p set:html={post.content.rendered} />
  ))
}
```

A WordPress REST API inclui [par√¢metros globais](https://developer.wordpress.org/rest-api/using-the-rest-api/global-parameters/) como `_fields` e `_embed`. 

Uma grande quantidade de dados est√° dispon√≠vel para voc√™ atrav√©s dessa API, ent√£o voc√™ pode querer obter apenas alguns campos. Voc√™ pode restringir a sua resposta ao adicionar o par√¢metro [`_fields`](https://developer.wordpress.org/rest-api/using-the-rest-api/global-parameters/#_fields) na URL da API, por exemplo: `[SEU-SITE]/wp/v2/posts?_fields=author,id,excerpt,title,link` 

A API tamb√©m pode retornar conte√∫do relacionado ao seu post, como um link para o post acima, ou para os coment√°rios do post. Voc√™ pode adicionar o par√¢metro [`_embed`](https://developer.wordpress.org/rest-api/using-the-rest-api/global-parameters/#_embed) na URL da API, (e.g. `[SEU-SITE]/wp/v2/posts?_embed`) para indicar ao servidor que a resposta deve incluir estes recursos embutidos.

## Construindo um blog com WordPress e Astro

Este exemplo obt√©m dados da API p√∫blica do WordPress [https://norian.studio/dinosaurs/](https://norian.studio/dinosaurs/). Este site WordPress armazena informa√ß√£o sobre dinossauros individualmente sob a rota `dinos`, assim como um blog armazenaria seus posts individuais sob a rota `posts`.

Este exemplo mostra como reproduzir esta estrutura de site no Astro: uma p√°gina √≠ndice que lista os dinossauros com links para p√°ginas de dinossauros individuais geradas dinamicamente.

:::note
Para usar [Custom Post Types (CPT)](https://learn.wordpress.org/lesson-plan/custom-post-types/) na sua API  WordPress (n√£o apenas `post` e `page`), voc√™ precisar√° [configur√°-las em seu painel WordPress](https://stackoverflow.com/questions/48536646/how-can-i-get-data-from-custom-post-type-using-wp-rest-api) ou [adicionar suporte REST API para Custom Content Types](https://developer.wordpress.org/rest-api/extending-the-rest-api/adding-rest-api-support-for-custom-content-types/) no WordPress.

Este exemplo obt√©m dados de um site WordPress cujo qual tipos de conte√∫do j√° foram configurados e expostos para a API REST.
:::

### Mostrando uma lista de posts WordPress

A p√°gina `src/pages/index.astro` lista cada dinossaurp, com uma descri√ß√£o e link para uma p√°gina pr√≥pria.

<FileTree title="Project Structure">
- src/
  - pages/
    - **index.astro**
    - dinos/
      - [slug].astro
- astro.config.mjs
- package.json
</FileTree>

A chamada para a API retorna u objeto que inclui as propriedades:

- `title.rendered` - Cont√©m o HTML do t√≠tulo do post.
- `content.rendered` - Cont√©m o HTML do conte√∫do do post.
- `slug` - Cont√©m o slug do post. (Isso fornece o link para as p√°ginas de dinossauro individuais geradas dinamicamente.)

```astro title="/src/pages/index.astro"
---
import Layout from "../layouts/Layout.astro";

let res = await fetch("https://norian.studio/wp-json/wp/v2/dinos");
let posts = await res.json();
---
<Layout title="Dinos!">
  <section>
    <h1>Lista de Dinossauros</h1>
    {
      posts.map((post) => (
        <article>
          <h2>
            <a href={`/dinos/${post.slug}/`} set:html={post.title.rendered} />
          </h2>
          <Fragment set:html={post.content.rendered} />
        </article>
      ))
    }
  </section>
</Layout>
```

### Usando a API WordPress para gerar p√°ginas

A p√°gina `src/pages/dinos/[slug].astro` [gera uma p√°gina dinamicamente](/pt-br/guides/routing/#rotas-din√¢micas) para cada dinossauro.

```astro title="/src/pages/dinos/[slug].astro"
---
import Layout from '../../layouts/Layout.astro';

const { slug } = Astro.params;

let res = await fetch(`https://norian.studio/wp-json/wp/v2/dinos?slug=${slug}`);
let [post] = await res.json();

// getStaticPaths() √© exigido para sites Astro est√°ticos.
// Se usar SSR, voc√™ n√£o precisar√° dessa fun√ß√£o.
export async function getStaticPaths() {
  let data = await fetch("https://norian.studio/wp-json/wp/v2/dinos");
  let posts = await data.json();

  return posts.map((post) => ({
    params: { slug: post.slug },
    props: { post: post },
  }));
}
---
<Layout title={post.title.rendered}>
  <article>
    <h1 set:html={post.title.rendered} />
    <Fragment set:html={post.content.rendered} />
  </article>
</Layout>
```

### Retornando recursos embutidos

O par√¢metro `_embed` instrui o servidor a retornar recursos (embutidos) relacionados.
```astro title="src/pages/dinos/[slug].astro" /&_embed/
---
const { slug } = Astro.params;

let res = await fetch(`https://norian.studio/wp-json/wp/v2/dinos?slug=${slug}&_embed`);
let [post] = await res.json();
---
```

A propriedade `_embedded['wp:featuredmedia']['0'].media_details.sizes.medium.source_url` √© retornada, e pode ser usada para mostrar a imagem destacada em cada p√°gina de dinossauro. (Substitua `medium` com o tamanho de imagem que deseja.)

```astro title="/src/pages/dinos/[slug].astro" {3}
<Layout title={post.title.rendered}>
  <article>
    <img src={post._embedded['wp:featuredmedia']['0'].media_details.sizes.medium.source_url} />
    <h1 set:html={post.title.rendered} />
    <Fragment set:html={post.content.rendered} />
  </article>
</Layout>
```

### Publicando seu site

Para lan√ßar seu site visite o nosso [guia de deploy](/pt-br/guides/deploy/) e siga as instru√ß√µes para o seu fornecedor de hospedagem preferido.

## Recursos da Comunidade 

- [Construindo um site Astro com WordPress como CMS Headless](https://blog.openreplay.com/building-an-astro-website-with-wordpress-as-a-headless-cms/) por Chris Bongers.
- [Construindo Astro x WordPress](https://www.youtube.com/watch?v=Jstqgklvfnc) pelo v√≠deo de Ben Holmes.
- [Construindo um Headless Wordpress com Astro](https://developers.wpengine.com/blog/building-a-headless-wordpress-site-with-astro) por Jeff Everhart.
- [Astro e WordPress como uma API](https://darko.io/posts/wp-as-an-api/) por Darko Bozhinovski.

## Sites em Produ√ß√£o

Os seguintes sites utilizam Astro + WordPress em produ√ß√£o:

- [Soft Hard System](https://softhardsystem.com/) por Rafid Muhymin Wafi ‚Äî [c√≥digo-fonte no GitHub](https://github.com/RafidMuhymin/softhardsystem)
- [Dinos!](https://wc-dinos.netlify.app/) por Anindo Neel Dutta ‚Äî [c√≥digo-fonte no GitHub](https://github.com/leen-neel/astro-wordpress)

## Temas

<Grid>
  <Card title="Astro WordPress Starter" href="https://astro.build/themes/details/astro-wordpress-starter/" thumbnail="astro-wordpress-starter.png"/>
</Grid>
