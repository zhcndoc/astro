---
type: integration
title: '@astrojs/lit'
description: "Apprenez √† utiliser l'int√©gration du framework @astrojs/lit pour √©largir la prise en charge des composants dans votre projet Astro."
githubIntegrationURL: 'https://github.com/withastro/astro/tree/main/packages/integrations/lit/'
category: renderer
i18nReady: true
---
import PackageManagerTabs from '~/components/tabs/PackageManagerTabs.astro'

Cette **[int√©gration Astro][astro-integration]** permet un rendu c√¥t√© serveur et une hydratation c√¥t√© client pour vos √©l√©ments personnalis√©s [Lit](https://lit.dev/).

## Installation

Astro inclut une commande `astro add` pour automatiser l'installation des int√©grations officielles. Si vous pr√©f√©rez, vous pouvez [installer les int√©grations manuellement](#installation-manuelle) √† la place.

Pour installer `@astrojs/lit`, ex√©cutez ce qui suit depuis le r√©pertoire de votre projet et suivez les instructions :

<PackageManagerTabs>
  <Fragment slot="npm">
    ```sh
    npx astro add lit
    ```
  </Fragment>
  <Fragment slot="pnpm">
    ```sh
    pnpm astro add lit
    ```
  </Fragment>
  <Fragment slot="yarn">
    ```sh
    yarn astro add lit
    ```
  </Fragment>
</PackageManagerTabs>

Si vous rencontrez des probl√®mes, [n'h√©sitez pas √† nous les signaler sur GitHub](https://github.com/withastro/astro/issues) et essayez les √©tapes d'installation manuelle ci-dessous.

### Installation manuelle

Tout d'abord, installez le paquet `@astrojs/lit` :

<PackageManagerTabs>
  <Fragment slot="npm">
    ```sh
    npm install @astrojs/lit
    ```
  </Fragment>
  <Fragment slot="pnpm">
    ```sh
    pnpm add @astrojs/lit
    ```
  </Fragment>
  <Fragment slot="yarn">
    ```sh
    yarn add @astrojs/lit
    ```
  </Fragment>
</PackageManagerTabs>

La plupart des gestionnaires de paquets installent √©galement les d√©pendances associ√©es. Si vous voyez un avertissement "Cannot find package 'lit'" (ou similaire) lorsque vous d√©marrez Astro, vous devrez installer `lit` et `@webcomponents/template-shadowroot` :

<PackageManagerTabs>
  <Fragment slot="npm">
    ```sh
    npm install lit @webcomponents/template-shadowroot
    ```
  </Fragment>
  <Fragment slot="pnpm">
    ```sh
    pnpm add lit @webcomponents/template-shadowroot
    ```
  </Fragment>
  <Fragment slot="yarn">
    ```sh
    yarn add lit @webcomponents/template-shadowroot
    ```
  </Fragment>
</PackageManagerTabs>

Ensuite, appliquez l'int√©gration √† votre fichier `astro.config.*` en utilisant la propri√©t√© `integrations` :

```js ins={2} ins="lit()" title="astro.config.mjs"
import { defineConfig } from 'astro/config';
import lit from '@astrojs/lit';

export default defineConfig({
  // ...
  integrations: [lit()],
});
```

## D√©marrage

Pour utiliser votre premier composant Lit dans Astro, consultez notre [documentation sur les Frameworks UI][astro-ui-frameworks]. Ceci explique :

* üì¶ comment les composants du Framework sont charg√©s,
* üíß les options d'hydratation c√¥t√© client, et
* ü§ù les possibilit√©s de m√©langer et d'imbriquer les Frameworks.

L'√©criture et l'importation d'un composant Lit dans Astro se pr√©sentent comme suit :

```js title="src/components/my-element.js"
import { LitElement, html } from 'lit';

export class MyElement extends LitElement {
  render() {
    return html`<p>Hello le monde! Depuis my-element</p>`;
  }
}

customElements.define('my-element', MyElement);
```

Le composant est maintenant pr√™t √† √™tre import√© via le frontmatter Astro :

```astro title="src/pages/index.astro"
---
import { MyElement } from '../components/my-element.js';
---

<MyElement />
```

:::note
Lit n√©cessite la pr√©sence de variables globales du navigateur tel que `HTMLElement` et `customElements`. Pour cette raison, le moteur de rendu Lit adapte le serveur avec ces √©l√©ments globaux pour que Lit puisse fonctionner. Il se peut que vous rencontriez des biblioth√®ques qui fonctionnent mal √† cause de cela.
:::

### D√©corateurs exp√©rimentaux

Pour utiliser les [d√©corateurs exp√©rimentaux dans Lit](https://lit.dev/docs/components/decorators/), ajoutez ce qui suit √† votre fichier `tsconfig.json` :

```json title="tsconfig.json" add={3}
{
  "compilerOptions": {
    "experimentalDecorators": true,
  }
}
```

Cela vous permet d'utiliser des d√©corateurs exp√©rimentaux tels que `@customElement` et `@state` pour enregistrer un √©l√©ment personnalis√© et d√©finir une propri√©t√© d'√©tat dans votre composant Lit :

```ts title="src/components/my-element.ts"
import { LitElement, html } from "lit";
import { customElement, state } from "lit/decorators.js";

@customElement("my-element")
export class MyElement extends LitElement {
    @state() name = "my-element";

    override render() {
        return html`<p>Bonjour √† tous ! De ${this.name}</p>`;
    }
}
```

### Polyfills et hydratation

Le moteur de rendu g√®re automatiquement l'ajout des polyfills appropri√©s pour le support des navigateurs qui n'ont pas Declarative Shadow DOM. Le polyfill fait environ *1.5kB*. Si le navigateur supporte Declarative Shadow DOM, moins de 250 octets sont charg√©s (pour d√©tecter le support).

L'hydratation est √©galement g√©r√©e automatiquement. Vous pouvez utiliser les m√™mes directives d'hydratation telles que `client:load`, `client:idle` et `client:visible` que vous pouvez utiliser avec d'autres biblioth√®ques support√©es par Astro.

```astro
---
import { MyElement } from '../components/my-element.js';
---

<MyElement client:visible />
```

Ce qui pr√©c√®de ne chargera le JavaScript de l'√©l√©ment que lorsque qu'il sera visible par l'utilsateur. Comme il s'agit d'un rendu serveur, l'utilisateur ne verra pas de jank ; le chargement et l'hydratation se feront de mani√®re transparente.

## D√©pannage

Pour obtenir de l'aide, consultez le canal `#support` sur [Discord](https://astro.build/chat). Nos sympathiques membres de l'√©quipe d'assistance sont l√† pour vous aider !

Vous pouvez √©galement consulter notre [Documentation d'int√©gration Astro][astro-integration] pour plus d'informations sur les int√©grations.

Les probl√®mes courants sont list√©s ci-dessous :

### √âl√©ments globaux du navigateur

Le SSR de l'int√©gration Lit fonctionne en ajoutant quelques propri√©t√©s globales du navigateur √† l'environnement global. Certaines des propri√©t√©s ajout√©es incluent `window`, `document`, et `location`.

Ces propri√©t√©s globales *peuvent* interf√©rer avec d'autres biblioth√®ques qui pourraient utiliser l'existence de ces variables pour d√©tecter qu'elles s'ex√©cutent dans le navigateur, alors qu'elles s'ex√©cutent en fait dans le serveur. Cela peut provoquer des bogues avec ces biblioth√®ques.

Pour cette raison, l'int√©gration de Lit peut ne pas √™tre compatible avec ces types de biblioth√®ques. Une chose qui peut aider est de changer l'ordre des int√©grations lorsque Lit interf√®re avec d'autres int√©grations :

```js lang="js" title="astro.config.mjs" ins={7} del={6}
  import { defineConfig } from 'astro/config';
  import vue from '@astrojs/vue';
  import lit from '@astrojs/lit';

  export default defineConfig({
    integrations: [vue(), lit()]
    integrations: [lit(), vue()]
  });
```

L'ordre correct peut √™tre diff√©rent en fonction de la cause fondamentale du probl√®me. Cependant, il n'est pas garanti que cela corrige tous les probl√®mes, et certaines biblioth√®ques ne peuvent pas √™tre utilis√©es si vous utilisez l'int√©gration Lit.

### Gestionnaires de paquets stricts

Lorsque vous utilisez un [gestionnaire de paquets strict](https://pnpm.io/pnpm-vs-npm#npms-flat-tree) comme `pnpm`, vous pouvez obtenir une erreur telle que `ReferenceError : module is not defined` lors de l'ex√©cution de votre site. Pour rem√©dier √† ce probl√®me, hissez les d√©pendances Lit avec un fichier `.npmrc` :

```ini title=".npmrc"
public-hoist-pattern[]=*lit*
```

### Limites

L'int√©gration Lit est aliment√©e par `@lit-labs/ssr` qui a quelques limitations. Voir leur [documentation sur les limitations](https://www.npmjs.com/package/@lit-labs/ssr#user-content-notes-and-limitations) pour en savoir plus.

- Astro ne prend pas en charge IntelliSense pour les composants Lit.

[astro-integration]: /fr/guides/integrations-guide/

[astro-ui-frameworks]: /fr/guides/framework-components/#utilisation-des-composants-de-framework
