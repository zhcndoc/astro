class t{static key="astro-tutorial-progress";static pageKey=t.slugFromPathname(window.location.pathname);static state={[t.pageKey]:{done:!1,lists:{}},...t.load()};static subscribers=new Map;static initialiseList(a){t.pageState.lists[a]||(t.pageState.lists[a]={primary:[],secondary:[]})}static initialiseSubList(a,i,e){t.pageState.lists[a][i].length!==e&&(t.pageState.lists[a][i]=Array.from({length:e},()=>!1),t.store())}static getSubListItem(a,i,e){return t.pageState.lists[a][i][e]}static setSubListItem(a,i,e,n){t.pageState.lists[a][i][e]=n,t.store()}static getPageDone(a){const i=t.state[t.slugFromPathname(a)];return!!i&&i.done}static subscribePageDone(a,i){return t.subscribers.set(i,a),i(t.getPageDone(a)),()=>void t.subscribers.delete(i)}static notifySubscribers(){for(const[a,i]of t.subscribers.entries())a(t.getPageDone(i))}static load(){try{const a=JSON.parse(localStorage.getItem(t.key)||"{}");if(t.validate(a))return a}catch{}return{}}static validate(a){return!!a&&typeof a=="object"&&Object.values(a).every(i=>"done"in i&&i.lists)}static store(){t.pageState.done=t.isPageDone,t.notifySubscribers();try{localStorage.setItem(t.key,JSON.stringify(t.state))}catch{}}static get pageState(){return t.state[t.pageKey]}static get isPageDone(){return Object.values(t.pageState.lists).every(t.isListDone)}static isListDone(a){return["primary","secondary"].map(i=>!!a[i].length&&a[i].every(e=>e)).some(i=>i)}static slugFromPathname(a){return a.split("/").slice(2).join("/").replace(/\/$/,"")}}export{t as P};
